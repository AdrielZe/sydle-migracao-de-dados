// Classe Arquivos para leitura (PDF) 

//Atualizar rascunho 

if(_object.arquivo){

  _object.output = _object.arquivo.getContentAsText("utf-8");
  
  if(camposExistem()){
      verificarSeCamposEstaoPreenchidos();
  } 
  
}


function verificarSeCamposEstaoPreenchidos(){
    
    const regexParaVerificarNome = /Nome :\s*(?!Idade\b)(\w+)\b/;
    const regexParaVerificarIdade = /Idade :\s*(?!Cargo\b)(\w+)\b/;
    const regexParaVerificarCargo = /Cargo :\s*(?!Salário\b)(\w+)\b/;
    const regexParaVerificarSalario = /Salário :\s*(\w+)\b/;
       
    if(!regexParaVerificarNome.test(_object.output)){
        throw "O campo de nome não está preenchido.";
    }
    if(!regexParaVerificarIdade.test(_object.output)){
        throw "O campo de Idade não está preenchido.";
    }
    if(!regexParaVerificarCargo.test(_object.output)){
        throw "O campo de Cargo não está preenchido.";
    }
    if(!regexParaVerificarSalario.test(_object.output)){
        throw "O campo de Salário não está preenchido.";
    }
    

    
    capturaDadosDoArquivo(regexParaVerificarNome,"nome");
    capturaDadosDoArquivo(regexParaVerificarIdade,"idade");
    capturaDadosDoArquivo(regexParaVerificarCargo, "cargo");
    capturaDadosDoArquivo(regexParaVerificarSalario, "salario");
}

function camposExistem(){
    return (_object.output.includes("Nome") && _object.output.includes("Idade") && _object.output.includes("Cargo") && _object.output.includes("Salário"))
}

function capturaDadosDoArquivo(regex,dado){
    const textoExtraidoDoArquivo = _object.output;
    const dadoCapturado = textoExtraidoDoArquivo.match(regex);
    _object[dado] = dadoCapturado[1];
}





//-----------------------------------------------------
// Classe Cliente cadastrados por arquivo

// Essa classe registra os clientes a partir do arquivo da classe Arquivos para leitura (PDF) 

//Por enquanto, ela não possui nenhum Script

//-----------------------------------------------------

// Processo cadastrar cliente por arquivo 

// Tarefa 1 - Atividade Humana - ( possui classe Arquivos para leitura embutida )

//Iniciar

if(!_pin) return

_object._executor = _object._creationUser;

if(_object){
    _object.arquivosParaLeituraAdriel = {};
}

//Finalizar

_pin.nome = _object.arquivosParaLeituraAdriel.nome;
_pin.idade = _object.arquivosParaLeituraAdriel.idade;
_pin.cargo = _object.arquivosParaLeituraAdriel.cargo;
_pin.salario = _object.arquivosParaLeituraAdriel.salario;

// Tarefa 2 - Script para criação automática de classes

// Iniciar

leituraDeArquivosAdriel.ClientesCadastradosPorArquivo._create({
    nome: _pin.nome,
    idade: _pin.idade,
    cargo: _pin.cargo,
    salario: _pin.salario
})